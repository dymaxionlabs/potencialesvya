<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Velocidad Internet</title>
      <meta name="description" content="">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="css/normalize.css">
      <link rel="stylesheet" href="css/main.css">
      <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  </head>
  <body>
      <div class="contents">
      <div id="dashboard_div" class="contents">
        <h1>Comparación Conexiones a Internet en mi Domicilio</h1>
        <p>En mi casa nos decidimos a probar por un mes el servicio de un proveedor adicional, en esta visualización se compara el rendimiento.</p>
        <h2>Potencia Promedio (en Mbps)</h2>
        <div id="summary"></div>
        <div id="dashboard_div" class="contents">
        <div id="filter_div"></div>
        <div id="gauges" align="center"></div> 
        <div id="filter"></div>         
        <h2>Evolución</h2>
        <div id="chart_div"></div>
        <div class="clearfix"></div>
      </div> 
      </div> 
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      // Load the Visualization API and the controls package.
      google.load('visualization', '1.0', {'packages':['controls']});
      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawDashboard);
      // Callback that creates and populates a data table,
      // instantiates a dashboard, a range slider and a pie chart,
      // passes in the data and draws it.
      function drawDashboard() {
        var data = google.visualization.arrayToDataTable([
          [Date,'Proveedor','Download','Upload','Latency'],
          [new Date(2015,5,1),'Claro - 3G',3.27,0.17,50],
          [new Date(2015,5,1),'Fibertel',11.66,2.97,15],
          [new Date(2015,5,1),'Speedy',8.59,0.92,37],
          [new Date(2015,5,2),'Claro - 3G',1.56,0.45,188],
          [new Date(2015,5,2),'Fibertel',11.77,2.34,13],
          [new Date(2015,5,2),'Speedy',8.75,1.4,37],
          [new Date(2015,5,3),'Claro - 3G',3.63,0.41,669],
          [new Date(2015,5,3),'Fibertel',12.13,3.07,16],
          [new Date(2015,5,3),'Speedy',8.25,1.11,38],
          [new Date(2015,5,4),'Claro - 3G',2.3,0.53,48],
          [new Date(2015,5,4),'Fibertel',11.82,2.73,14],
          [new Date(2015,5,4),'Speedy',8.52,1.02,36],
          [new Date(2015,5,5),'Claro - 3G',2.87,0.55,50],
          [new Date(2015,5,5),'Fibertel',8.39,1.27,33],
          [new Date(2015,5,5),'Speedy',8.3,0.82,108],
          [new Date(2015,5,6),'Claro - 3G',3.81,0.56,48],
          [new Date(2015,5,6),'Fibertel',12.21,2.41,19],
          [new Date(2015,5,6),'Speedy',8.67,0.83,35],
          [new Date(2015,5,7),'Claro - 3G',6.3,0.59,49],
          [new Date(2015,5,7),'Fibertel',11.84,2.82,16],
          [new Date(2015,5,7),'Speedy',8.15,0.82,82],
          [new Date(2015,5,8),'Claro - 3G',1.31,1.05,76],
          [new Date(2015,5,8),'Fibertel',10.56,2.14,11],
          [new Date(2015,5,8),'Speedy',8.47,0.88,35],
          [new Date(2015,5,9),'Claro - 3G',2.76,0.53,53],
          [new Date(2015,5,9),'Fibertel',6.88,1.45,17],
          [new Date(2015,5,9),'Speedy',5.38,0.85,49],
          [new Date(2015,5,10),'Claro - 3G',0.82,0.36,96],
          [new Date(2015,5,10),'Fibertel',9.46,1.94,18],
          [new Date(2015,5,10),'Speedy',4.92,0.83,216],
          [new Date(2015,5,11),'Claro - 3G',7.01,1.01,48],
          [new Date(2015,5,11),'Fibertel',10.85,1.91,14],
          [new Date(2015,5,11),'Speedy',7.2,0.85,35],
          [new Date(2015,5,12),'Claro - 3G',2.96,0.97,42],
          [new Date(2015,5,12),'Fibertel',12.3,2.32,18],
          [new Date(2015,5,12),'Speedy',8.66,0.86,33],
          [new Date(2015,5,13),'Claro - 3G',1.26,0.72,48],
          [new Date(2015,5,13),'Fibertel',11.6,2.27,21],
          [new Date(2015,5,13),'Speedy',8.61,0.53,25],
          [new Date(2015,5,14),'Claro - 3G',2.4,1.13,46],
          [new Date(2015,5,14),'Fibertel',3.17,2.26,14],
          [new Date(2015,5,14),'Speedy',4.54,0.81,199],
          [new Date(2015,5,15),'Claro - 3G',3.06,1.15,40],
          [new Date(2015,5,15),'Fibertel',5.94,2.65,18],
          [new Date(2015,5,15),'Speedy',8.62,0.44,34],
          [new Date(2015,5,16),'Claro - 3G',1.31,0.66,51],
          [new Date(2015,5,16),'Fibertel',11.08,2.57,21],
          [new Date(2015,5,16),'Speedy',1.83,0.58,42],
          [new Date(2015,5,17),'Claro - 3G',5.27,1.26,47],
          [new Date(2015,5,17),'Fibertel',10.71,2.81,17],
          [new Date(2015,5,17),'Speedy',2.1,0.48,197],
          [new Date(2015,5,18),'Claro - 3G',1.31,0.97,46],
          [new Date(2015,5,18),'Fibertel',10.71,2.34,11],
          [new Date(2015,5,18),'Speedy',8.18,0.74,34],
          [new Date(2015,5,19),'Claro - 3G',0.88,0.52,60],
          [new Date(2015,5,19),'Fibertel',11.71,2.17,17],
          [new Date(2015,5,19),'Speedy',6.14,1.01,40],
          [new Date(2015,5,20),'Claro - 3G',0.39,0.57,57],
          [new Date(2015,5,20),'Fibertel',12.41,1.82,15],
          [new Date(2015,5,20),'Speedy',7.55,1.07,81],
          [new Date(2015,5,21),'Claro - 3G',3.29,1.16,51],
          [new Date(2015,5,21),'Fibertel',2.7,2.27,16],
          [new Date(2015,5,21),'Speedy',8.45,1.08,84],
          [new Date(2015,5,22),'Claro - 3G',2.6,1.18,48],
          [new Date(2015,5,22),'Fibertel',4.79,0.84,15],
          [new Date(2015,5,22),'Speedy',4.53,1.29,40],
          [new Date(2015,5,23),'Claro - 3G',6.81,1.2,47],
          [new Date(2015,5,23),'Fibertel',16.41,10.65,16],
          [new Date(2015,5,23),'Speedy',8.67,0.88,34],
          [new Date(2015,5,24),'Claro - 3G',0.9,1.1,40],
          [new Date(2015,5,24),'Fibertel',10.71,2.03,25],
          [new Date(2015,5,24),'Speedy',4.25,0.83,38],
          [new Date(2015,5,25),'Claro - 3G',1.43,0.69,42],
          [new Date(2015,5,25),'Fibertel',10.27,2.81,17],
          [new Date(2015,5,25),'Speedy',8.1,0.8,81],
          [new Date(2015,5,26),'Claro - 3G',0.23,0.47,50],
          [new Date(2015,5,26),'Fibertel',8.94,2.21,14],
          [new Date(2015,5,26),'Speedy',2.37,0.73,202],
          [new Date(2015,5,27),'Claro - 3G',0.54,0.1,465],
          [new Date(2015,5,27),'Fibertel',6.67,2.51,29],
          [new Date(2015,5,27),'Speedy',3.65,0.64,88],
          [new Date(2015,5,28),'Claro - 3G',6.18,1.15,46],
          [new Date(2015,5,28),'Fibertel',11.25,2.53,16],
          [new Date(2015,5,28),'Speedy',5.15,0.8,199],
          [new Date(2015,5,29),'Claro - 3G',1.63,0.5,40],
          [new Date(2015,5,29),'Fibertel',12.33,2.78,17],
          [new Date(2015,5,29),'Speedy',2.96,1.2,37],
          [new Date(2015,5,30),'Claro - 3G',1.46,1.17,44],
          [new Date(2015,5,30),'Fibertel',10.13,2.7,16],
          [new Date(2015,5,30),'Speedy',3.06,0.7,41],
          [new Date(2015,6,1),'Claro - 3G',3.23,2.12,49],
          [new Date(2015,6,1),'Fibertel',10.61,2.54,18],
          [new Date(2015,6,1),'Speedy',7.56,1.29,32],
          [new Date(2015,6,2),'Claro - 3G',0.66,1.89,102],
          [new Date(2015,6,2),'Fibertel',11.63,2.52,15],
          [new Date(2015,6,2),'Speedy',6.17,0.88,30],
          [new Date(2015,6,3),'Claro - 3G',0.72,0.79,81],
          [new Date(2015,6,3),'Fibertel',10.1,2.41,21],
          [new Date(2015,6,3),'Speedy',4,0.83,35],
          [new Date(2015,6,4),'Claro - 3G',4.73,1.06,47],
          [new Date(2015,6,4),'Fibertel',10.24,2.24,15],
          [new Date(2015,6,4),'Speedy',10.32,0.8,84],
          [new Date(2015,6,5),'Claro - 3G',0.78,1.43,64],
          [new Date(2015,6,5),'Fibertel',11.15,2.5,16],
          [new Date(2015,6,5),'Speedy',7.41,0.73,176],
          [new Date(2015,6,6),'Claro - 3G',5.88,1.21,55],
          [new Date(2015,6,6),'Fibertel',10.47,2.68,18],
          [new Date(2015,6,6),'Speedy',6.53,0.64,80],
          [new Date(2015,6,7),'Claro - 3G',0.95,1.19,53],
          [new Date(2015,6,7),'Fibertel',7.2,2.58,17],
          [new Date(2015,6,7),'Speedy',6.62,0.8,172],
          [new Date(2015,6,8),'Claro - 3G',6.61,1.29,49],
          [new Date(2015,6,8),'Fibertel',9.5,2.42,13],
          [new Date(2015,6,8),'Speedy',4.83,1.2,32]
        ]);
        // Create a dashboard.
        var dashboard = new google.visualization.Dashboard(
            document.getElementById('dashboard_div'));
        // Create a range slider, passing some options
         rangeSlider = new google.visualization.ControlWrapper({
            controlType: 'ChartRangeFilter',
            containerId: 'filter',
            options: {
                // Filter by the date axis.
                filterColumnIndex: 0,
                ui: {
                    chartType: 'LineChart',
                    chartOptions : {height: 50, lineWidth:1, vAxis: {title: 'Latency'}},
                    minRangeSize: 172800000,
                    //chartOptions : {'height': 50, 'lineWidth':1}
                    // Display a single series that shows the closing value of the stock.
                    // Thus, this view has two columns: the date (axis) and the stock value (line series).
                    chartView: {
                        columns: [0, 4]
                    },
                }
            },
            // Initial range: 2012-02-09 to 2012-03-20.
            state: {
                range: {
                    start: new Date(2015,5,1,00,00,00),
                    end: new Date(2015,6,8,23,59,59)
                }
            }
        });
        var connTypeSlider = new google.visualization.ControlWrapper({
          'controlType': 'CategoryFilter',
          'containerId': 'filter_div',
          'options': {
            'filterColumnLabel': 'Proveedor',
            ui: {
                caption: 'Choose a brand',
                sortValues: true,
                allowNone: false,
                allowMultiple: false,
                allowTyping: true}            
          }
        });
          // Create a pie chart, passing some options
        var lineChart = new google.visualization.ChartWrapper({
          'chartType': 'LineChart',
          'containerId': 'chart_div',
          options: {
            lineWidth: 3,
            areaOpacity:0.5,
            legend: {position:'top', textStyle: {fontSize: 12}},
            height: 150,
            vAxis: {title: 'Velocidad (Mbps)'
              },
            },
          'view': {'columns': [0, 2,3]}
        }); 
        // set up a dataTable for the gauges
        
        var gaugeData = new google.visualization.DataTable();
          gaugeData.addColumn('string', 'Series');
          gaugeData.addColumn('number', 'Average');
          
          gauges = new google.visualization.ChartWrapper({
              chartType: 'Gauge',
              dataTable: gaugeData,
              containerId: 'gauges',
              options: {
                  redFrom: 12,
                  redTo: 15,
                  yellowFrom: 9,
                  yellowTo: 12,
                  minorTicks: 3,
                  max: 15,
                  // you need to add dimensions to this or you will get funny effects when you pan or zoom the rangeSlider
                  height: 300,
                  width: 400
              }
          });
           google.visualization.events.addListener(gauges, 'ready', onReady);
    
    function onReady() {
        //var obj = gauges.getDataSourceUrl();
        //alert("Loaded! " + obj);
        //console.log(obj);
    }
    
    // set up event listener to draw the gauge when the dashboard is done
    google.visualization.events.addListener(dashboard, 'ready', function (e) {
        var view = lineChart.getDataTable();
        var group = google.visualization.data.group(view, [{
            column: 0,
            type: 'number',
            modifier: function () {
                // make them all the same for grouping
                return 0;
            }
        }], [{
            column: 2,
            type: 'number',
            label: view.getColumnLabel(2),
            aggregation: google.visualization.data.avg
        }, {
            column: 3,
            type: 'number',
            label: view.getColumnLabel(3),
            aggregation: google.visualization.data.avg
        }]);
        var formatter = new google.visualization.NumberFormat({pattern: '#,##'});
        
        // clear the gaugeData table
        if (gaugeData.getNumberOfRows() > 0) {
            gaugeData.removeRows(0, gaugeData.getNumberOfRows());
        }
        // populate the gaugeData table
        for (var i = 1; i < group.getNumberOfColumns(); i++) {
            gaugeData.addRow([group.getColumnLabel(i), Math.round(100*group.getValue(0, i))/100]);
        }
        gauges.draw();
    });

 
        // Establish dependencies, declaring that 'filter' drives 'pieChart',
        // so that the pie chart will only display entries that are let through
        // given the chosen slider range.
        dashboard.bind(connTypeSlider, lineChart);
        dashboard.bind(rangeSlider, lineChart);
        // Draw the dashboard.
        dashboard.draw(data);
      }
      </script>
  </body>
</html>